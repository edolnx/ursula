<VirtualHost *:5001>
    LogLevel  info
    ErrorLog  /var/log/apache2/keystone-error.log
    CustomLog /var/log/apache2/keystone-access.log combined
    Options +FollowSymLinks
    ProxyPass / balancer://keystone

    Include /etc/apache2/ssl.conf
    SSLCertificateFile /etc/apache2/ssl.crt
    SSLCertificateKeyFile /etc/apache2/ssl.key
</VirtualHost>

<Proxy balancer://keystone>
{% for host in groups['controller'] -%}
  BalancerMember http://{{ hostvars[host][primary_interface]['ipv4']['address'] }}:5000/
{% endfor %}
</Proxy>
